test {
	name 'simple print'
	case {
		[console] hello
	}
	expect "
		hello
		
	`"
}

test {
	name 'effects in print message'
	case {
		[console] ([console] hello)
	}
	expect "
		hello
		hello
		
	`"
}

test {
	name 'print inside function'
	case {
		[root Function] void {
			[console] hello
		} whatever
	}
	expect "
		hello
		
	`"
}

test {
	name 'print inside scope'
	case {
		[root Scope] {
			[console] hello
		}
	}
	expect "
		hello
		
	`"
}

test {
	name 'function alias'
	case {
		[root Function] print {
			(print hello) (print world)
		} ([root Function] message {
			[console] message
		})
	}
	expect "
		hello
		world
		
	`"
}

test {
	name 'environment alias'
	case {
		{
			hello
		} [console]
	}
	expect "
		hello
		
	`"
}

test {
	name 'environment alias multiple'
	case {
		{
			hello world
		} [console]
	}
	expect "
		hello
		world
		
	`"
}

test {
	name 'effects in function name'
	case {
		[root Function] ([console] hello)
	}
	expect "
		hello
		
	`"
}

test {
	name 'effects in void paramater'
	case {
		[root Function] void {whatever} ([console] hello)
	}
	expect "
		hello
		
	`"
}

test {
	name 'effects in environment'
	case {
		{void} ([root Function] void {[console] hello})
	}
	expect "
		hello
		
	`"
}

test {
	name 'multiple effects in environment'
	case {
		{void void void} ([root Function] void {[console] hello})
	}
	expect "
		hello
		hello
		hello
		
	`"
}

test {
	name 'single effect used multiple times'
	case {
		{void void void} ([console] hello)
	}
	expect "
		hello
		
	`"
}

test {
	name 'effects in enviroment call'
	case {
		{lol lol} ([root Function] void {[console] hello})
	}
	expect "
		hello
		hello
		
	`"
}

test {
	name 'effects in enviroment call with indirection'
	case {
		[root Function] msg {
			{lol lol} ([root Function] void {[console] msg})
		} hello
	}
	expect "
		hello
		hello
		
	`"
}

test {
	name 'function alias with do'
	case {
		[root Function] print {
			[root ``] (print hello) (print world)
		} ([root Function] message {
			[console] message
		})
	}
	expect "
		hello
		world
		
	`"
}

test {
	name 'print inside function using arg'
	case {
		[root Function] arg {
			[console] arg
		} hello
	}
	expect "
		hello`n
	`"
}

test {
	name 'do case'
	case {
		[root ``] ([console] hello) ([console] world)
	}
	expect "
		hello
		world
		
	`"
}

test {
	name 'nested do cases'
	case {
		[root ``] (
			[root ``] (
				[root ``] (
					[root ``] ([console] hello) ([console] world)
				) ([console] world)
			) ([console] world)
		) ([console] world)
	}
	expect "
		hello
		world
		world
		world
		world
		
	`"
}

test {
	name 'nested effects with indirection'
	case {
		[root Function] message {
			[root Function] void {
				[console] message
			} void
		} hello
	}
	expect "
		hello
		
	`"
}